{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Admin\\\\Documents\\\\quiz maker client\\\\src\\\\pages\\\\public\\\\start_quiz\\\\StartExamQuiz.js\",\n    _s = $RefreshSig$();\n\nimport React, { useContext, useEffect, useRef, useState } from 'react';\nimport { Box, Button, Checkbox, Container, Divider, Flex, Heading, HStack, IconButton, SimpleGrid, Text, Tooltip, VStack, AlertDialog, AlertDialogBody, AlertDialogFooter, AlertDialogHeader, AlertDialogContent, AlertDialogOverlay } from \"@chakra-ui/react\";\nimport { ArrowDownIcon, ArrowUpIcon, TimeIcon } from \"@chakra-ui/icons\";\nimport { useQuiz } from \"../../../providers/QuizProvider\";\nimport axios from \"axios\";\nimport { useHistory, useParams } from \"react-router-dom\";\nimport quizApi from \"../../../api/quizApi\";\nimport CustomAlertDialog from \"../../../components/CustomAlertDialog\";\nimport { useAdmin, useAuth } from \"../../../hooks/useAuth\";\nimport QuizService from \"../../../service/QuizService\";\nimport SubmitReportEntry from \"./SubmitReportEntry\";\nimport format from 'dateformat';\nimport UserService from \"../../../service/UserService\";\nimport { AdminContext } from \"../../../providers/AdminSettingProvider\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst StartQuiz = () => {\n  _s();\n\n  var _report$quizScore;\n\n  const [foundedQuiz, setFoundedQuiz] = useState();\n  const {\n    isLoading,\n    setLoading\n  } = useContext(AdminContext);\n  const {\n    code\n  } = useParams();\n  const [isOpen, setOpen] = useState(false);\n  const [report, setReport] = useState({\n    answers: []\n  });\n  const cancelRef = useRef();\n  const {\n    user\n  } = useAuth();\n  const [submitContent, setSubmitContent] = useState({\n    answers: []\n  });\n  const history = useHistory();\n  const {\n    setFullMode\n  } = useAdmin(); //alert dialog\n\n  const [isOpen2, setIsOpen2] = React.useState(false);\n\n  const onClose = () => setIsOpen2(false);\n\n  const cancelRef2 = React.useRef();\n  const [timer, setTimer] = useState('');\n\n  const countDownTime = async duration => {\n    duration = duration * 60;\n    let timer = duration,\n        minutes,\n        seconds;\n    let i = setInterval(function () {\n      minutes = parseInt(timer / 60);\n      seconds = parseInt(timer % 60);\n      minutes = minutes <= 0 ? \"0\" + minutes : minutes;\n      seconds = seconds <= 0 ? \"0\" + seconds : seconds;\n      setTimer(minutes + \":\" + seconds);\n      setSubmitContent(prev => ({ ...prev,\n        finishTime: new Date()\n      }));\n\n      if (--timer <= 0) {\n        setOpen(true);\n        clearInterval(i);\n      }\n    }, 1000);\n  };\n\n  useEffect(async () => {\n    setFullMode(false);\n    setLoading(true);\n\n    try {\n      setLoading(true);\n      const resp2 = await UserService.getAssignedQuizDetail(code);\n      setFoundedQuiz(resp2.data);\n      setSubmitContent(prev => ({ ...prev,\n        quizId: resp2.data.id,\n        startTime: new Date()\n      }));\n      countDownTime(resp2.data.limitTime);\n    } catch (e) {\n      console.log(e.response.data); // history.push('/')\n    } finally {\n      setLoading(false);\n    }\n\n    setLoading(false);\n  }, []);\n\n  const onCheckOption = (e, question, option) => {\n    if (e.target.checked) {\n      if (submitContent.answers.filter(item => item.questionId === question.questionId).length > 0) {\n        setSubmitContent(prev => ({ ...prev,\n          answers: prev.answers.map(item => item.questionId !== question.questionId ? item : { ...item,\n            options: [...new Set([...item.options, option.optionId])]\n          })\n        }));\n      } //\n      else {\n        setSubmitContent(prev => ({ ...prev,\n          answers: [...prev.answers, {\n            questionId: question.questionId,\n            options: [option.optionId]\n          }]\n        }));\n      }\n    } else {\n      setSubmitContent(prev => {\n        return { ...prev,\n          answers: prev.answers.map(item => {\n            if (item.questionId !== question.questionId) {\n              return item;\n            } else {\n              return { ...item,\n                options: [...new Set(item.options.filter(optionId => optionId !== option.optionId))]\n              };\n            }\n          })\n        };\n      });\n    }\n  };\n\n  const submitAnswers = async () => {\n    try {\n      setLoading(true);\n      const data = await UserService.submitExamQuiz(JSON.stringify(submitContent));\n      setReport(data.data);\n      console.log(data.data); // window.location.reload();\n    } catch (e) {} finally {\n      window.scroll(0, 0);\n      setLoading(false);\n    }\n  };\n\n  const getQuestionAndOption = (questionId, optionId) => {\n    if (!isLoading && report) {\n      for (let i = 0; i < report.answers.length; i++) {\n        let questionAnswer = report.answers[i];\n\n        if (questionAnswer.id === questionId) {\n          for (let j = 0; j < questionAnswer.options.length; j++) {\n            if (questionAnswer.options[j].id === optionId) {\n              return true;\n            }\n          }\n        }\n      }\n\n      return false;\n    }\n\n    return false;\n  };\n\n  return /*#__PURE__*/_jsxDEV(Flex, {\n    direction: 'column',\n    bg: 'blue.100',\n    children: [/*#__PURE__*/_jsxDEV(CustomAlertDialog, {\n      title: 'Submit answers',\n      description: 'Are you sure? You can\\'t undo this action afterwards.',\n      isOpen: isOpen,\n      setOpen: setOpen,\n      cancelRef: cancelRef,\n      onSubmit: () => submitAnswers()\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 185,\n      columnNumber: 13\n    }, this), report && /*#__PURE__*/_jsxDEV(Box, {\n      bg: '',\n      mx: '5',\n      mt: '5',\n      p: 5,\n      children: [/*#__PURE__*/_jsxDEV(Heading, {\n        children: \"Submit Report\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 195,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(SimpleGrid, {\n        spacing: 5,\n        columns: '4',\n        py: 5,\n        children: [/*#__PURE__*/_jsxDEV(SubmitReportEntry, {\n          title: 'score',\n          content: `${report.score}/${(_report$quizScore = report.quizScore) !== null && _report$quizScore !== void 0 ? _report$quizScore : 0}`\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 197,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(SubmitReportEntry, {\n          title: 'questions',\n          content: `${report.submitQuestionsCount}/${report.numOfQuestions}`\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 198,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(SubmitReportEntry, {\n          title: 'startTime',\n          content: `${format(report.startTime, \"dd-mm hh:MM\")}`\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 200,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(SubmitReportEntry, {\n          title: 'finishTime',\n          content: `${format(report.finishTime, \"dd-mm hh:MM\")}`\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 201,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(SubmitReportEntry, {\n          title: 'attempt',\n          content: `${report.attempt}`\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 202,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 196,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 24\n    }, this), /*#__PURE__*/_jsxDEV(Box, {\n      minH: '100vh',\n      bg: 'blue.100',\n      p: 10,\n      align: 'center',\n      children: !isLoading && foundedQuiz && /*#__PURE__*/_jsxDEV(Box, {\n        bg: 'white',\n        borderRadius: 'md',\n        boxShadow: 'xl',\n        minH: '100vh',\n        maxW: '860px',\n        p: 10,\n        children: [/*#__PURE__*/_jsxDEV(VStack, {\n          position: 'relative',\n          children: [/*#__PURE__*/_jsxDEV(Heading, {\n            pb: 10,\n            color: 'purple.600',\n            fontSize: 30,\n            children: foundedQuiz != null ? foundedQuiz.title : ''\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 221,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(Text, {\n            fontWeight: 'medium',\n            color: 'teal',\n            letterSpacing: 1,\n            fontStyle: 'italic',\n            position: 'absolute',\n            top: 0,\n            right: 0,\n            m: 5,\n            children: [foundedQuiz && foundedQuiz.questions && foundedQuiz.questions.length, \" Questions\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 228,\n            columnNumber: 29\n          }, this), !isLoading && foundedQuiz && foundedQuiz.questions && foundedQuiz.questions.map((question, i) => /*#__PURE__*/_jsxDEV(VStack, {\n            w: '100%',\n            align: 'start',\n            textAlign: 'start',\n            p: 2,\n            spacing: 5,\n            children: [/*#__PURE__*/_jsxDEV(Container, {\n              w: '100%',\n              maxW: \"4xl\",\n              children: /*#__PURE__*/_jsxDEV(Box, {\n                maxW: \"4xl\",\n                children: /*#__PURE__*/_jsxDEV(Text, {\n                  fontWeight: 'medium',\n                  fontSize: 20,\n                  color: 'purple.900',\n                  children: [i + 1, \". \", question.title, \" \\\\t QuestionID : \", question.questionId]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 253,\n                  columnNumber: 49\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 252,\n                columnNumber: 45\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 251,\n              columnNumber: 41\n            }, this), /*#__PURE__*/_jsxDEV(SimpleGrid, {\n              w: '100%',\n              columns: 2,\n              spacing: 4,\n              align: 'start',\n              textAlign: 'start',\n              children: question.options.map((option, i) => {\n                let filterElement = submitContent.answers.filter(v => v['questionId'] === question.questionId)[0];\n                return /*#__PURE__*/_jsxDEV(Container, {\n                  w: '100%',\n                  minW: 300,\n                  // maxW=\"xl\"\n                  align: 'start',\n                  textAlign: 'start',\n                  alignItems: 'start',\n                  children: /*#__PURE__*/_jsxDEV(Box, {\n                    padding: 1 // maxW=\"3xl\"\n                    ,\n                    children: /*#__PURE__*/_jsxDEV(Checkbox // isChecked={report && getQuestionAndOption(question.questionId, option.optionId)}\n                    // isDisabled={report != null}\n                    // defaultChecked={\n                    //     // ((!isLoading && report && getQuestionAndOption(question.questionId, option.optionId))\n                    //     (filterElement && filterElement.options.filter(o => o === option.optionId)[0])\n                    //     // )\n                    // }\n                    , {\n                      defaultChecked: !isLoading && report && getQuestionAndOption(question.questionId, option.optionId) || filterElement && filterElement.options.filter(o => o === option.optionId)[0],\n                      onChange: e => onCheckOption(e, question, option),\n                      value: option.optionId,\n                      colorScheme: 'teal',\n                      size: 'lg',\n                      children: [option.content, \" \\\\t OptionID : \", option.optionId]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 282,\n                      columnNumber: 65\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 278,\n                    columnNumber: 61\n                  }, this)\n                }, i, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 269,\n                  columnNumber: 57\n                }, this);\n              })\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 259,\n              columnNumber: 41\n            }, this), /*#__PURE__*/_jsxDEV(Divider, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 307,\n              columnNumber: 41\n            }, this)]\n          }, i, true, {\n            fileName: _jsxFileName,\n            lineNumber: 242,\n            columnNumber: 37\n          }, this)), /*#__PURE__*/_jsxDEV(Box, {\n            py: 5,\n            align: 'end',\n            alignSelf: 'end',\n            children: /*#__PURE__*/_jsxDEV(Button, {\n              isDisabled: report !== null,\n              onClick: () => {\n                setOpen(true);\n                setSubmitContent(prevState => ({ ...prevState,\n                  finishTime: new Date()\n                }));\n              },\n              alignSelf: 'end',\n              size: 'lg',\n              colorScheme: 'teal',\n              children: \"Submit\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 313,\n              columnNumber: 33\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 312,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 216,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(HStack, {\n          zIndex: 100,\n          position: 'fixed',\n          bottom: 10,\n          right: 20,\n          children: [/*#__PURE__*/_jsxDEV(Tooltip, {\n            label: \"Scroll to top\",\n            children: /*#__PURE__*/_jsxDEV(IconButton, {\n              onClick: () => window.scrollTo(0, 0),\n              colorScheme: 'teal',\n              icon: /*#__PURE__*/_jsxDEV(ArrowUpIcon, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 332,\n                columnNumber: 43\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 329,\n              columnNumber: 33\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 328,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(Tooltip, {\n            label: \"Scroll to bottom\",\n            children: /*#__PURE__*/_jsxDEV(IconButton // aria-label={\"\"}\n            , {\n              onClick: () => {// pageRef.current.scrollIntoView({\n                //     behavior: \"smooth\",\n                //     block: \"end\",\n                //     inline: \"nearest\"\n                // })\n              },\n              colorScheme: 'teal',\n              icon: /*#__PURE__*/_jsxDEV(ArrowDownIcon, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 345,\n                columnNumber: 43\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 335,\n              columnNumber: 33\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 334,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 327,\n          columnNumber: 25\n        }, this), report === null && /*#__PURE__*/_jsxDEV(Flex, {\n          p: 1,\n          position: 'fixed',\n          left: 0,\n          top: 0,\n          m: 10,\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            isDisabled: report !== null,\n            size: 'md',\n            colorScheme: 'teal',\n            variant: 'outline',\n            leftIcon: /*#__PURE__*/_jsxDEV(TimeIcon, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 352,\n              columnNumber: 43\n            }, this),\n            children: [timer || 'No Time Limit', ' ', \"left\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 349,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 348,\n          columnNumber: 45\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 209,\n        columnNumber: 50\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 206,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(AlertDialog, {\n      isOpen: isOpen2,\n      leastDestructiveRef: cancelRef2,\n      onClose: onClose,\n      children: /*#__PURE__*/_jsxDEV(AlertDialogOverlay, {\n        children: /*#__PURE__*/_jsxDEV(AlertDialogContent, {\n          children: [/*#__PURE__*/_jsxDEV(AlertDialogHeader, {\n            fontSize: \"lg\",\n            fontWeight: \"bold\",\n            children: \"Delete Customer\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 367,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(AlertDialogBody, {\n            children: \"Are you sure? You can't undo this action afterwards.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 371,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(AlertDialogFooter, {\n            children: [/*#__PURE__*/_jsxDEV(Button, {\n              ref: cancelRef2,\n              onClick: onClose,\n              children: \"Cancel\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 376,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(Button, {\n              colorScheme: \"red\",\n              onClick: onClose,\n              ml: 3,\n              children: \"Delete\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 379,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 375,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 366,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 365,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 360,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 184,\n    columnNumber: 9\n  }, this);\n};\n\n_s(StartQuiz, \"3kAoIyhLZM0TUAe4d/eEzp/KiNc=\", false, function () {\n  return [useParams, useAuth, useHistory, useAdmin];\n});\n\n_c = StartQuiz;\nexport default StartQuiz;\n\nvar _c;\n\n$RefreshReg$(_c, \"StartQuiz\");","map":{"version":3,"sources":["C:/Users/Admin/Documents/quiz maker client/src/pages/public/start_quiz/StartExamQuiz.js"],"names":["React","useContext","useEffect","useRef","useState","Box","Button","Checkbox","Container","Divider","Flex","Heading","HStack","IconButton","SimpleGrid","Text","Tooltip","VStack","AlertDialog","AlertDialogBody","AlertDialogFooter","AlertDialogHeader","AlertDialogContent","AlertDialogOverlay","ArrowDownIcon","ArrowUpIcon","TimeIcon","useQuiz","axios","useHistory","useParams","quizApi","CustomAlertDialog","useAdmin","useAuth","QuizService","SubmitReportEntry","format","UserService","AdminContext","StartQuiz","foundedQuiz","setFoundedQuiz","isLoading","setLoading","code","isOpen","setOpen","report","setReport","answers","cancelRef","user","submitContent","setSubmitContent","history","setFullMode","isOpen2","setIsOpen2","onClose","cancelRef2","timer","setTimer","countDownTime","duration","minutes","seconds","i","setInterval","parseInt","prev","finishTime","Date","clearInterval","resp2","getAssignedQuizDetail","data","quizId","id","startTime","limitTime","e","console","log","response","onCheckOption","question","option","target","checked","filter","item","questionId","length","map","options","Set","optionId","submitAnswers","submitExamQuiz","JSON","stringify","window","scroll","getQuestionAndOption","questionAnswer","j","score","quizScore","submitQuestionsCount","numOfQuestions","attempt","title","questions","filterElement","v","o","content","prevState","scrollTo"],"mappings":"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","sourcesContent":["import React, {useContext, useEffect, useRef, useState} from 'react';\r\nimport {\r\n    Box,\r\n    Button,\r\n    Checkbox,\r\n    Container,\r\n    Divider, Flex,\r\n    Heading,\r\n    HStack, IconButton,\r\n    SimpleGrid,\r\n    Text,\r\n    Tooltip,\r\n    VStack,\r\n    AlertDialog,\r\n    AlertDialogBody,\r\n    AlertDialogFooter,\r\n    AlertDialogHeader,\r\n    AlertDialogContent,\r\n    AlertDialogOverlay,\r\n} from \"@chakra-ui/react\";\r\nimport {ArrowDownIcon, ArrowUpIcon, TimeIcon} from \"@chakra-ui/icons\";\r\nimport {useQuiz} from \"../../../providers/QuizProvider\";\r\nimport axios from \"axios\";\r\nimport {useHistory, useParams} from \"react-router-dom\";\r\nimport quizApi from \"../../../api/quizApi\";\r\nimport CustomAlertDialog from \"../../../components/CustomAlertDialog\";\r\nimport {useAdmin, useAuth} from \"../../../hooks/useAuth\";\r\nimport QuizService from \"../../../service/QuizService\";\r\nimport SubmitReportEntry from \"./SubmitReportEntry\";\r\nimport format from 'dateformat';\r\nimport UserService from \"../../../service/UserService\";\r\nimport {AdminContext} from \"../../../providers/AdminSettingProvider\";\r\n\r\nconst StartQuiz = () => {\r\n\r\n    const [foundedQuiz, setFoundedQuiz] = useState();\r\n    const {isLoading, setLoading} = useContext(AdminContext);\r\n    const {code} = useParams();\r\n    const [isOpen, setOpen] = useState(false);\r\n    const [report, setReport] = useState({answers: []});\r\n    const cancelRef = useRef();\r\n    const {user} = useAuth();\r\n    const [submitContent, setSubmitContent] = useState({answers: []});\r\n    const history = useHistory();\r\n    const {setFullMode} = useAdmin();\r\n    //alert dialog\r\n    const [isOpen2, setIsOpen2] = React.useState(false)\r\n    const onClose = () => setIsOpen2(false)\r\n    const cancelRef2 = React.useRef()\r\n    const [timer, setTimer] = useState('');\r\n    const countDownTime = async (duration) => {\r\n        duration = duration * 60;\r\n        let timer = duration, minutes, seconds;\r\n        let i = setInterval(function () {\r\n            minutes = parseInt(timer / 60);\r\n            seconds = parseInt(timer % 60);\r\n\r\n            minutes = minutes <= 0 ? \"0\" + minutes : minutes;\r\n            seconds = seconds <= 0 ? \"0\" + seconds : seconds;\r\n            setTimer(minutes + \":\" + seconds);\r\n\r\n            setSubmitContent(prev => ({\r\n                ...prev,\r\n                finishTime: new Date()\r\n            }))\r\n            if (--timer <= 0) {\r\n                setOpen(true);\r\n                clearInterval(i);\r\n            }\r\n        }, 1000);\r\n\r\n    }\r\n    useEffect(async () => {\r\n            setFullMode(false);\r\n            setLoading(true);\r\n    \r\n            try {\r\n                setLoading(true);\r\n                const resp2 = await UserService.getAssignedQuizDetail(code);\r\n                setFoundedQuiz(resp2.data);\r\n                setSubmitContent((prev) => ({\r\n                    ...prev, quizId: resp2.data.id, startTime: new Date()\r\n\r\n                }))\r\n                countDownTime(resp2.data.limitTime);\r\n            } catch (e) {\r\n                console.log(e.response.data);\r\n                // history.push('/')\r\n            } finally {\r\n                setLoading(false);\r\n            }\r\n\r\n\r\n            setLoading(false);\r\n        }\r\n        , []);\r\n\r\n\r\n    const onCheckOption = (e, question, option) => {\r\n        if (e.target.checked) {\r\n            if ((submitContent.answers.filter((item) => item.questionId === question.questionId)).length > 0) {\r\n                setSubmitContent((prev) => ({\r\n                    ...prev,\r\n                    answers: prev.answers.map((item) => item.questionId !== question.questionId ? item : {\r\n                        ...item,\r\n                        options: [\r\n                            ...new Set([...item.options,\r\n                                option.optionId])\r\n                        ]\r\n                    })\r\n                }))\r\n            }\r\n            //\r\n            else {\r\n                setSubmitContent((prev) => ({\r\n                    ...prev,\r\n                    answers: [...prev.answers, {\r\n                        questionId: question.questionId,\r\n                        options: [\r\n                            option.optionId\r\n                        ]\r\n                    }]\r\n                }))\r\n            }\r\n        } else {\r\n            setSubmitContent((prev) => {\r\n                return {\r\n                    ...prev,\r\n                    answers: prev.answers.map((item) => {\r\n                            if (item.questionId !== question.questionId) {\r\n                                return item;\r\n                            } else {\r\n                                return ({\r\n                                    ...item,\r\n                                    options: [\r\n                                        ...new Set(item.options.filter(optionId => optionId !== option.optionId))\r\n                                    ]\r\n                                })\r\n\r\n                            }\r\n\r\n\r\n                        }\r\n                    )\r\n                }\r\n            })\r\n        }\r\n    }\r\n    const submitAnswers = async () => {\r\n        try {\r\n            setLoading(true);\r\n            const data = await UserService.submitExamQuiz(JSON.stringify(submitContent));\r\n            setReport(data.data);\r\n            console.log(data.data);\r\n            // window.location.reload();\r\n        } catch (e) {\r\n\r\n\r\n        } finally {\r\n            window.scroll(0, 0);\r\n            setLoading(false);\r\n        }\r\n\r\n    }\r\n    const getQuestionAndOption = (questionId, optionId) => {\r\n        if (!isLoading && report) {\r\n\r\n            for (let i = 0; i < report.answers.length; i++) {\r\n                let questionAnswer = report.answers[i];\r\n                if (questionAnswer.id === questionId) {\r\n                    for (let j = 0; j < questionAnswer.options.length; j++) {\r\n                        if (questionAnswer.options[j].id === optionId) {\r\n                            return true;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            return false;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    return (\r\n        <Flex direction={'column'} bg={'blue.100'}>\r\n            <CustomAlertDialog\r\n                title={'Submit answers'}\r\n                description={'Are you sure? You can\\'t undo this action afterwards.'}\r\n                isOpen={isOpen}\r\n                setOpen={setOpen}\r\n                cancelRef={cancelRef}\r\n                onSubmit={() => submitAnswers()}\r\n            />\r\n            {/*QUIZ SUBMIT ANSWERS REPORT*/}\r\n            {report && <Box bg={''} mx={'5'} mt={'5'} p={5}>\r\n                <Heading>Submit Report</Heading>\r\n                <SimpleGrid spacing={5} columns={'4'} py={5}>\r\n                    <SubmitReportEntry title={'score'} content={`${report.score}/${report.quizScore ?? 0}`}/>\r\n                    <SubmitReportEntry title={'questions'}\r\n                                       content={`${report.submitQuestionsCount}/${report.numOfQuestions}`}/>\r\n                    <SubmitReportEntry title={'startTime'} content={`${format(report.startTime, \"dd-mm hh:MM\")}`}/>\r\n                    <SubmitReportEntry title={'finishTime'} content={`${format(report.finishTime, \"dd-mm hh:MM\")}`}/>\r\n                    <SubmitReportEntry title={'attempt'} content={`${report.attempt}`}/>\r\n                </SimpleGrid>\r\n            </Box>}\r\n\r\n            <Box minH={'100vh'} bg={'blue.100'} p={10}\r\n                 align={'center'}>\r\n                {\r\n                    !isLoading && foundedQuiz && <Box\r\n                        bg={'white'}\r\n                        borderRadius={'md'}\r\n                        boxShadow={'xl'}\r\n                        minH={'100vh'}\r\n                        maxW={'860px'}\r\n                        p={10}>\r\n                        <VStack position={'relative'}>\r\n\r\n                            {/*\r\n                           QUIZ TITLE\r\n                           */}\r\n                            <Heading\r\n                                pb={10}\r\n                                color={'purple.600'}\r\n                                fontSize={30}>\r\n                                {foundedQuiz != null ? foundedQuiz.title : ''}\r\n                            </Heading>\r\n                            {/*NUMBER OF QUESTIONS*/}\r\n                            <Text\r\n                                fontWeight={'medium'}\r\n                                color={'teal'}\r\n                                letterSpacing={1}\r\n                                fontStyle={'italic'}\r\n                                position={'absolute'}\r\n                                top={0}\r\n                                right={0}\r\n                                m={5}>\r\n                                {foundedQuiz && foundedQuiz.questions && foundedQuiz.questions.length} Questions\r\n                            </Text>\r\n                            {/*QUESTIONS*/}\r\n                            {\r\n                                !isLoading && foundedQuiz && foundedQuiz.questions && foundedQuiz.questions.map((question, i) => (\r\n                                    <VStack\r\n                                        w={'100%'}\r\n                                        align={'start'}\r\n                                        textAlign={'start'} key={i}\r\n                                        p={2}\r\n                                        spacing={5}>\r\n                                        {/*\r\n                                    QUESTION TITLE\r\n                                    */}\r\n                                        <Container w={'100%'} maxW=\"4xl\">\r\n                                            <Box maxW=\"4xl\">\r\n                                                <Text fontWeight={'medium'} fontSize={20} color={'purple.900'}>\r\n                                                    {i + 1}. {question.title} \\t QuestionID : {question.questionId}\r\n                                                </Text>\r\n                                            </Box>\r\n                                        </Container>\r\n                                        {/*OPTIONS*/}\r\n                                        <SimpleGrid\r\n                                            w={'100%'}\r\n                                            columns={2}\r\n                                            spacing={4}\r\n                                            align={'start'}\r\n                                            textAlign={'start'}>\r\n                                            {\r\n                                                question.options.map((option, i) => {\r\n                                                    let filterElement = submitContent.answers.filter(v => v['questionId'] === question.questionId)[0];\r\n                                                    return (\r\n                                                        <Container\r\n                                                            w={'100%'}\r\n                                                            minW={300}\r\n                                                            key={i}\r\n                                                            // maxW=\"xl\"\r\n                                                            align={'start'}\r\n                                                            textAlign={'start'}\r\n                                                            alignItems={'start'}\r\n                                                        >\r\n                                                            <Box\r\n                                                                padding={1}\r\n                                                                // maxW=\"3xl\"\r\n                                                            >\r\n                                                                <Checkbox\r\n                                                                    // isChecked={report && getQuestionAndOption(question.questionId, option.optionId)}\r\n                                                                    // isDisabled={report != null}\r\n                                                                    // defaultChecked={\r\n                                                                    //     // ((!isLoading && report && getQuestionAndOption(question.questionId, option.optionId))\r\n                                                                    //     (filterElement && filterElement.options.filter(o => o === option.optionId)[0])\r\n                                                                    //     // )\r\n                                                                    // }\r\n                                                                    defaultChecked={\r\n                                                                        ((!isLoading && report && getQuestionAndOption(question.questionId, option.optionId))\r\n                                                                            || (filterElement && filterElement.options.filter(o => o === option.optionId)[0])\r\n                                                                        )\r\n                                                                    }\r\n                                                                    onChange={(e) => onCheckOption(e, question, option)}\r\n                                                                    value={option.optionId}\r\n                                                                    colorScheme={'teal'}\r\n                                                                    size={'lg'}>\r\n                                                                    {option.content} \\t OptionID : {option.optionId}\r\n                                                                </Checkbox>\r\n                                                            </Box>\r\n                                                        </Container>\r\n                                                    );\r\n                                                })\r\n                                            }\r\n                                        </SimpleGrid>\r\n                                        <Divider/>\r\n                                    </VStack>\r\n                                ))\r\n                            }\r\n                            {/* Submit button*/}\r\n                            <Box py={5} align={'end'} alignSelf={'end'}>\r\n                                <Button\r\n                                    isDisabled={report !== null}\r\n                                    onClick={() => {\r\n                                        setOpen(true)\r\n                                        setSubmitContent((prevState => ({\r\n                                            ...prevState,\r\n                                            finishTime: new Date(),\r\n                                        })))\r\n                                    }}\r\n                                    alignSelf={'end'} size={'lg'} colorScheme={'teal'}>Submit</Button>\r\n                            </Box>\r\n                        </VStack>\r\n\r\n                        {/* FIXED CONTENTS*/}\r\n                        <HStack zIndex={100} position={'fixed'} bottom={10} right={20}>\r\n                            <Tooltip label={\"Scroll to top\"}>\r\n                                <IconButton\r\n                                    onClick={() => window.scrollTo(0, 0)}\r\n                                    colorScheme={'teal'}\r\n                                    icon={<ArrowUpIcon/>}/>\r\n                            </Tooltip>\r\n                            <Tooltip label={\"Scroll to bottom\"}>\r\n                                <IconButton\r\n                                    // aria-label={\"\"}\r\n                                    onClick={() => {\r\n                                        // pageRef.current.scrollIntoView({\r\n                                        //     behavior: \"smooth\",\r\n                                        //     block: \"end\",\r\n                                        //     inline: \"nearest\"\r\n                                        // })\r\n                                    }}\r\n                                    colorScheme={'teal'}\r\n                                    icon={<ArrowDownIcon/>}/>\r\n                            </Tooltip>\r\n                        </HStack>\r\n                        {report === null && <Flex p={1} position={'fixed'} left={0} top={0} m={10}>\r\n                            <Button\r\n                                isDisabled={report !== null}\r\n                                size={'md'} colorScheme={'teal'} variant={'outline'}\r\n                                leftIcon={<TimeIcon/>}>{timer || 'No Time Limit'}{' '}\r\n                                left</Button>\r\n                        </Flex>}\r\n                    </Box>\r\n\r\n\r\n                }\r\n            </Box>\r\n            <AlertDialog\r\n                isOpen={isOpen2}\r\n                leastDestructiveRef={cancelRef2}\r\n                onClose={onClose}\r\n            >\r\n                <AlertDialogOverlay>\r\n                    <AlertDialogContent>\r\n                        <AlertDialogHeader fontSize='lg' fontWeight='bold'>\r\n                            Delete Customer\r\n                        </AlertDialogHeader>\r\n\r\n                        <AlertDialogBody>\r\n                            Are you sure? You can't undo this action afterwards.\r\n                        </AlertDialogBody>\r\n\r\n                        <AlertDialogFooter>\r\n                            <Button ref={cancelRef2} onClick={onClose}>\r\n                                Cancel\r\n                            </Button>\r\n                            <Button colorScheme='red' onClick={onClose} ml={3}>\r\n                                Delete\r\n                            </Button>\r\n                        </AlertDialogFooter>\r\n                    </AlertDialogContent>\r\n                </AlertDialogOverlay>\r\n            </AlertDialog>\r\n        </Flex>\r\n    );\r\n};\r\n\r\nexport default StartQuiz;"]},"metadata":{},"sourceType":"module"}